<!DOCTYPE html>
<html class="no-js">
<head>
	<title>lDragonBow</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Roboto">
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="stylesheet" type="text/css" href="loader.css">
	<script src="js/modernizr-2.6.2.min.js"></script>
</head>

<body>
	<header class="entry-header">
		<h1 id="load-header">Loading...</h1>
	</header>

	<div id="loader-wrapper">
		<div id="loader"></div>
		<div class="loader-section section-left"></div>
        <div class="loader-section section-right"></div>
	</div>
	
	<div id="skrollr-body">
		<div id="music-logo"></div>
		<div id="Scene">
			<div class="slide-1 parallax-layer"
				data-0="top:0px;transform:scale(1,1);opacity:0.8"
				data-1000="top:-200px;transform:scale(1.5,1.5);"
				data-2000="top:-450px;"			
				data-3000="top:-720px;opacity:0;">
				<div class="content parallax-layer"
				data-0="top:0px;opacity:1"
				data-1000="top:200px;"
				data-2000="top:450px;"			
				data-3000="top:1000px;opacity:0;">
				<h1>Scroll down to the World of Anime...</h1>
				</div>
				<div id="front-char"></div>
			</div>
			<div id="story" class="parallax-layer"
				data-1000="opacity:0;"
				data-2000="opacity:0.5;"			
				data-3000="opacity:1;">
				<div id="sky-bg" class="parallax-layer"
					data-5000="left:0px;"
					data-10000="left:-1000px;"
					data-12000="left:-1400px;">
				</div>
				<div id="sun"
					data-5000="top:200px;"
					data-7000="top:-200px;"
					data-8000="top:-100px;"
					data-9000="top:-50px;"
					data-10000="top:50px;">
				</div>
				<div id="bird"
					data-5000="left:-150px;"
					data-10000="left:1500px;"
					></div>
				<div id="moving-cloud"
					data-5000="left:1500px;"
					data-10000="left:-2000px;">
				</div>
				<div id="land-bg" class="parallax-layer"
					data-5000="left:0px;"
					data-10000="left:-2500px;"
					data-12000="left:-2900px;">
				</div>
				<div id="puppy"
					data-5000="left:2200px;"
					data-10000="left:-300px;">
				</div>
				<div id="msg_container"
					data-5000="left:600px;transform:scale(0,0)"
					data-5100="transform:scale(1,1)"
					data-10000="left:-1900px;">
					<p class="msg" style="padding-top: 15px;margin-left: 20px;padding-left: 10px;padding-right: 140px;">Hi everyone I'm Debbie,<br> I'm an anime character.<br> Nice to meet you. :D</p>
				</div>
				<div id="msg_container2"
					data-6100="left:600px;transform:scale(0,0)"
					data-6200="transform:scale(1,1)"
					data-11100="left:-1900px;">
					<p class="msg" style="padding-left: 15px;padding-top: 20px;padding-right: 140px;">Oh no a cute lion on the way<br>I need to Jump! <br>Yieeehh...Hhhhaaaaa!</p>
				</div>
				<div id="msg_container3"
					data-7500="left:600px;transform:scale(0,0)"
					data-7600="transform:scale(1,1)"
					data-12500="left:-1900px;">
					<p class="msg" style="padding-top: 15px;margin-left: 20px;padding-left: 10px;padding-right: 140px;">Am I coooaaal?<br>But it's a little bit lonely<br>Let's try to find someone..</p>
				</div>
				<div id="msg_container4"
					data-11800="left:250px;transform:scale(0,0)"
					data-11900="left:250px;transform:scale(1,1)">
					<p class="msg" style="padding-top: 15px;margin-left: 20px;padding-left: 10px;padding-right: 140px;">Hey wait a minute.<br>I can see someone.<br>....................</p>
				</div>
				<div class="parallax-layer">
					<div id="dbow"></div>
				</div>
				<div id="trees-passing4"
					data-8500="left:2500px;"
					data-10000="left:-1500px;">
				</div>
				<div id="trees-passing1"
					data-8500="left:4400px;"
					data-10000="left:-3500px;">
				</div>
				<div id="view-borders" class="parallax-layer"
					data-5000="left:0px;"
					data-10000="left:-2500px;"
					data-12000="left:-2900px;"
					data-13000="left:-2900px;">
				</div>
			</div>
			<div id="story2"
				data-12950="opacity:0"
				data-13000="opacity:1"
				data-17500="background-color: hsl(0,0%,11.8%);"
				data-18500="background-color: hsl(0,0%,0%);">
				<p class="message" style="font-size:36px"
				data-13000="opacity:1;top:300px;left:200px;"
				data-13500="opacity:0"> 
				Anime characters were <strong>unique</strong></p>
				<p class="message" style="font-size:42px"
				data-14000="opacity:0;top:100px;left:600px;"
				data-14100="opacity:1;"
				data-14500="opacity:0">
				Most of them were <strong>delicate and beutiful</strong></p>
				<p class="message"
				data-14700="opacity:0;top:300px;left:200px;"
				data-14900="opacity:1;"
				data-15200="opacity:0">
				Watching them was <strong>fun</strong></p>
				<p class="message"
				data-15400="opacity:0;top:300px;left:800px;"
				data-15600="opacity:1;"
				data-15900="opacity:0">
				They <strong>care</strong> for someone</p>
				<p class="message" style="font-size:36px"
				data-16100="opacity:0;top:320px;left:550px;"
				data-16400="opacity:1;"
				data-16700="opacity:0">
				They're <strong>full of emotions</strong></p>
				<p class="message" style="font-size:36px"
				data-17800="opacity:0;top:90px;left:550px;"
				data-18500="opacity:1;"
				data-19050="opacity:1"
				data-19200="opacity:0">
				Right there was <strong>Love</strong>...</p>
				<p class="message" style="font-size:36px"
				data-20350="opacity:0;top:320px;left:550px;"
				data-20550="opacity:1;"
				data-20650="opacity:1;"
				data-21350="opacity:0">
				Yet <strong>change<strong> is the only thing that exist forever...</p>
				<div id="slidescene1" class="parallax-layer"
					data-13500="left:2000px;"
					data-13700="left:200px;transform-origin:top left;"
					data-14000="transform:scale(1,1)"
					data-14100="transform:scale(0.4,0.4);margin-right:20px;"
					data-17500="opacity:1"
					data-18500="opacity:0">
				</div>
				<div id="slidescene2" class="parallax-layer"
					data-14300="left:-2000px;"
					data-14500="left:200px;transform-origin:top right;"
					data-14800="transform:scale(1,1);top:250px"
					data-14900="transform:scale(0.4,0.4);top:100px"
					data-17500="opacity:1"
					data-18500="opacity:0">
				</div>
				<div id="slidescene3" class="parallax-layer"
					data-15100="left:2000px;"
					data-15300="left:200px;transform-origin:bottom left;"
					data-15500="transform:scale(1,1);"
					data-15600="transform:scale(0.4,0.4);"
					data-17500="opacity:1"
					data-18500="opacity:0">
				</div>
				<div id="slidescene4" class="parallax-layer"
					data-15800="left:-2000px;"
					data-16000="left:200px;transform-origin:bottom right;"
					data-16300="transform:scale(1,1)"
					data-16400="transform:scale(0.4,0.4)"
					data-17500="opacity:1"
					data-18500="opacity:0">
				</div>
				<div id="slidescene5" class="parallax-layer"
					data-16600="opacity:0;transform:scale(1,1)"
					data-17500="opacity:1;transform:scale(1.5,1.5)"
					data-19050="opacity:1"
					data-19200="opacity:0">
				</div>
				<div id="cracking"></div>
				<div id="broken_glass"></div>
				<video id="bdn" src="music_videos/bdn-roar.mp4" type="video/mp4" width="1360px" height="720px"
					data-21350="opacity:0"
					data-21450="opacity:1">
				</video>
			</div>
		</div>
	</div>
	<audio id="audio" src="music_videos/cd1-01-little-busters-.mp3" autoplay loop="infinite"></audio>
	<script src="js/jquery.min.js"></script>
	<script src="js/3d-falling-leaves.min.js" type="text/javascript"></script>
	<script src="js/rotate3Di.min.js" type="text/javascript"></script>
	<script src="js/skrollr.min.js"></script>
	<script type="text/javascript">
		var music = $('audio#audio');
		var changeMusic = 0;

		var dbow = $('div#dbow'),
		picLocs = [0, -250, -500, -750, -1000, -1250, -1500 , -1750, -2000],
		curForm = 0,				//current image in spritesheet
		lastScroll = 0,				//last position of scroll bar (Y-axis) 
		animationCycle, 			//no. of image in spritesheet
		backPosY,					//changing bg position Y-axis in spritesheet form (e.g. walking to jumping)
		jumping = '-190px',
		running = '0px',
		leftPos_char = 300,
		yPos;

		var bird = $('div#bird'),
		picLocs2 = [0, -60, -120],
		curForm2 = 0,
		lastScroll2 = 0;

		var msg_container = $('div#msg_container'),
		picLocs3 = [0, -400, -800, -1200, -1600, -2000, -2400, -2800, -3200, -3600],
		curForm3 = 0,
		lastScroll3 = 0;

		var msg_container2 = $('div#msg_container2'),
		picLocs4 = [0, -432, -864, -1296, -1728, -2160, -2592, -3024, -3456, -3888],
		curForm4 = 0,
		lastScroll4 = 0;

		var msg_container3 = $('div#msg_container3'),
		picLocs5 = [0, -400, -800, -1200, -1600, -2000, -2400, -2800, -3200, -3600],
		curForm5 = 0,
		lastScroll5 = 0;

		var cracking = $('div#cracking'),
		picLocs6 = [0, -1366, -2732, -4098, -5464, -6830, -8196, -9562, -10928, -12294, -13660, -15026, -16392, -17758, -19124, -20490, -21856, -23222, -24588, -25954, -27320, -28686,],
		curForm6 = 0,
		lastScroll6 = 0;

		var broken_glass = $('div#broken_glass'),
		picLocs7 = [0, -1366, -2732, -4098, -5464, -6830, -8196],
		curForm7 = 0,
		lastScroll7 = 0;

		var skrollr = skrollr.init({
			smoothScrolling: true,
			beforerender: function(scrollPos){
				//if the scrollbar reach the scene
				console.log('Scroll: '+scrollPos.curTop)								
				if (scrollPos.curTop < 5000) {
					$(document).octoberLeaves('start');
				} else if (scrollPos.curTop >= 5000) {			//stopping the falling-leaves to minimize 													//lag when scroll reach the scene
					$(document).octoberLeaves('stop');
				}

				if (scrollPos.curTop >= 5000 && scrollPos.curTop < 12500) {	
					if (changeMusic == 1){						
						music.attr('src','cd1-01-little-busters-.mp3');	//music change when user scrolls 																back
						changeMusic = 0;
					}
					$('div#story').css('display','block');		//returning the display if user scrolls back

					//----Character animation---//
					if (scrollPos.curTop < 6200 || scrollPos.curTop >= 7700) {
						animationCycle = 9;
						backPosY = running;
						console.log('running...');
						yPos = 380;
						dbow.css('top', yPos + 'px');
					} else if (scrollPos.curTop >= 6200 && scrollPos.curTop < 7700) {	//jump at this range
						animationCycle = 4;
						backPosY = jumping;
						console.log('jumping...' + animationCycle + '....' + backPosY);
					}
					
					if (backPosY == running) {
						//if the user scroll 50px down we will move to the next frame in our char spritesheet
	 					if (scrollPos.curTop > lastScroll + 50) {
							if (curForm >= animationCycle - 1) { 
								curForm = -1; 
							}
							dbow.css('background-position', picLocs[++curForm] + 'px ' + backPosY);
							lastScroll = scrollPos.curTop;
							if (scrollPos.curTop >= 10000 && scrollPos.curTop < 11000) {
								leftPos_char -= 20;
								dbow.css('left', leftPos_char + 'px');
							}
						//if the user scroll 50px up we will move back to the previous frame in our char spritesheet
						} else if (scrollPos.curTop < lastScroll - 50) {
							if (curForm <= 0) { 
								curForm = animationCycle; 
							}
							dbow.css('background-position', picLocs[--curForm] + 'px ' + backPosY);
							lastScroll = scrollPos.curTop;
							if (scrollPos.curTop >= 10000 && scrollPos.curTop < 11000) {
								leftPos_char += 20;
								dbow.css('left', leftPos_char + 'px');
							}
						}
					} else if (backPosY == jumping) {
						if (scrollPos.curTop > lastScroll + 170) {
							if (curForm >= animationCycle - 1) { 
								curForm = -1; 
							}
							dbow.css('background-position', picLocs[++curForm] + 'px ' + backPosY);
							lastScroll = scrollPos.curTop;
							if (backPosY == jumping) {
								if (scrollPos.curTop < 6950) {
								yPos -= 60;
								}
								if (scrollPos.curTop >= 6950) {
								yPos += 60;
								}
							}
							dbow.css('top', yPos + 'px');
						} else if (scrollPos.curTop < lastScroll - 170) {
							if (curForm <= 0) { 
								curForm = animationCycle; 
							}
							dbow.css('background-position', picLocs[--curForm] + 'px ' + backPosY);
							lastScroll = scrollPos.curTop;
							if (backPosY == jumping) {
								if (scrollPos.curTop <= 6950) {
								yPos += 60;
								}
								if (scrollPos.curTop > 6950) {
								yPos -= 60;
								}
							}
							dbow.css('top', yPos + 'px');
						}
					}

					//--bird's animation---//
					//if the user scroll 50px down we will move back to the previous frame in our bird spritesheet
					if (scrollPos.curTop > lastScroll2 + 50) {
						if (curForm2 >= 2) {
							curForm2 = -1;
						}
						bird.css('background-position', picLocs2[++curForm2] + 'px 0px');
						lastScroll2 = scrollPos.curTop;
					//if the user scroll 50px up we will move back to the previous frame in our bird spritesheet
					} else if (scrollPos.curTop < lastScroll2 - 50) {
						if (curForm2 <= 0) { 
							curForm2 = 3; 
						}
						bird.css('background-position', picLocs2[--curForm2] + 'px 0px');
						lastScroll2 = scrollPos.curTop;
					}

					//--msg_container's animation---//
					//if the user scroll 50px down we will move back to the previous frame in our msg_container spritesheet
					if (scrollPos.curTop >= 5100 && scrollPos.curTop < 6200) {
						if (scrollPos.curTop > lastScroll3 + 110) {
							if (curForm3 >= 9) {
								curForm3 = 8;
							}
							msg_container.css('background-position', picLocs3[++curForm3] + 'px 0px');
							lastScroll3 = scrollPos.curTop;
						//if the user scroll 50px up we will move back to the previous frame in our msg_container spritesheet
						} else if (scrollPos.curTop < lastScroll3 - 110) {
							if (curForm3 <= 0) { 
								curForm3 = 1; 
							}
							msg_container.css('background-position', picLocs3[--curForm3] + 'px 0px');
							lastScroll3 = scrollPos.curTop;
						}
					}

					//--msg_container2's animation---//
					//if the user scroll 50px down we will move back to the previous frame in our msg_container2 spritesheet
					if(scrollPos.curTop >= 6200 && scrollPos.curTop < 7500) {
						if (scrollPos.curTop > lastScroll4 + 110) {
							if (curForm4 >= 9) {
								curForm4 = 8;
							}
							msg_container2.css('background-position', picLocs4[++curForm4] + 'px 0px');
							lastScroll4 = scrollPos.curTop;
						//if the user scroll 50px up we will move back to the previous frame in our msg_container2 spritesheet
						} else if (scrollPos.curTop < lastScroll4 - 110) {
							if (curForm4 <= 0) { 
								curForm4 = 1; 
							}
							msg_container2.css('background-position', picLocs4[--curForm4] + 'px 0px');
							lastScroll4 = scrollPos.curTop;
						}
					}

					//--msg_container3's animation---//
					//if the user scroll 50px down we will move back to the previous frame in our msg_container3 spritesheet
					if(scrollPos.curTop >= 7600 && scrollPos.curTop < 9000) {
						if (scrollPos.curTop > lastScroll5 + 110) {
							if (curForm5 >= 9) {
								curForm5 = 8;
							}
							msg_container3.css('background-position', picLocs5[++curForm5] + 'px 0px');
							lastScroll5 = scrollPos.curTop;
						//if the user scroll 50px up we will move back to the previous frame in our msg_container3 spritesheet
						} else if (scrollPos.curTop < lastScroll5 - 110) {
							if (curForm5 <= 0) { 
								curForm5 = 1; 
							}
							msg_container3.css('background-position', picLocs5[--curForm5] + 'px 0px');
							lastScroll5 = scrollPos.curTop;
						}
					}
				} else if (scrollPos.curTop >= 12800 && scrollPos.curTop < 19850) {
					$('div#story').css('display','none');
					autoscroll = 1;
					if (changeMusic == 0) {
						music.attr('src','music_videos/Koubou-SNS.mp3');
						changeMusic = 1;
					}
					$(function () {											//autoscrolling
					    var lastScroll_story2 = $(window).scrollTop();
					    $(window).scroll(function () {
					    	console.log('autoscrolling....');
					        var scrollTop = $(window).scrollTop();
					        if (scrollTop > lastScroll_story2 && (scrollTop >= 12500 && scrollTop < 15100) ) {
					            $('body').stop().animate({
					                scrollTop: 21450
					            }, 20000,'linear');
					        }
					        lastScroll_story2 = scrollTop;
					    });
					});
				}

				if (scrollPos.curTop >= 18200 && scrollPos.curTop < 19850) cracking.css('display','block');
				else cracking.css('display','none');
				if (scrollPos.curTop >= 19850 && scrollPos.curTop < 20350) broken_glass.css('display','block');
				else broken_glass.css('display','none');
				//--cracking's animation---//
				//if the user scroll 50px down we will move back to the previous frame in our cracking spritesheet
				if (scrollPos.curTop >= 18200 && scrollPos.curTop < 19850) {
					if (scrollPos.curTop > lastScroll6 + 50) {
						if (curForm6 >= 22) {
							curForm6 = 21;
						}
						cracking.css('background-position', picLocs6[++curForm6] + 'px 0px');
						lastScroll6 = scrollPos.curTop;
					//if the user scroll 50px up we will move back to the previous frame in our cracking spritesheet
					} else if (scrollPos.curTop < lastScroll6 - 50) {
						if (curForm6 <= 0) { 
							curForm6 = 1; 
						}
						cracking.css('background-position', picLocs6[--curForm6] + 'px 0px');
						lastScroll6 = scrollPos.curTop;
					}
				}


				//--broken_glass's animation---//
				//if the user scroll 50px down we will move back to the previous frame in our broken_glass spritesheet
				if (scrollPos.curTop >= 19850 && scrollPos.curTop < 20350) {
					if (scrollPos.curTop > lastScroll7 + 50) {
						if (curForm7 >= 7) {
							curForm7 = 6;
						}
						broken_glass.css('background-position', picLocs7[++curForm7] + 'px 0px');
						lastScroll7 = scrollPos.curTop;
					//if the user scroll 50px up we will move back to the previous frame in our broken_glass spritesheet
					} else if (scrollPos.curTop < lastScroll7 - 50) {
						if (curForm7 <= 0) { 
							curForm7 = 1; 
						}
						broken_glass.css('background-position', picLocs7[--curForm7] + 'px 0px');
						lastScroll7 = scrollPos.curTop;
					}
				}
				if (scrollPos.curTop >= 21350 && scrollPos.curTop < 26000) {
					$('video#bdn').get(0).play();
					$('audio#audio').prop("muted",1);
				} else if (scrollPos.curTop >= 26000 || scrollPos.curTop < 21350) {
					$('audio#audio').prop("muted",0);
					$('video#bdn').get(0).pause();
				}
			}
		});
	</script>
	<script type="text/javascript" src="js/toggle-mute.js"></script>
	<script type="text/javascript" src="js/loaded.js"></script>
</body>
</html>